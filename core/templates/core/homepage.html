{% extends "base.html" %}
{% load static %}

{% block title %}Home | Profile{% endblock %}

{% block content %}
<div class="app-container home-grid">
  <header class="app-header">
    <h1 class="app-title mb-1">Share your feelings. Find your people.</h1>
    <p class="app-subtitle mt-0">A kinder space to express yourself and connect with others.</p>
  </header>

  {% if user.is_authenticated %}
  <section class="home-main">
    <!-- Friendly CTA row -->
    <div class="quick-actions">
      <a class="qa-btn primary" href="{% url 'feed' %}">Start a Post</a>
      <a class="qa-btn" href="{% url 'feed' %}">Open Feed</a>
      <a class="qa-btn" href="{% url 'feed' %}">Check Comments</a>
      <button class="qa-btn" type="button" disabled title="More coming soon">More soon</button>
    </div>

    <!-- Gentle guidance section -->
    <div class="section mt-3">
      <h3 class="section-title"><span class="section-icon"></span> Tips for a kinder space</h3>
      <ul class="trend-list compact mt-2">
        <li>Be respectful and honestâ€”someone out there relates to you.</li>
        <li>Mark supportive comments to highlight kindness.</li>
      </ul>
    </div>

    {% if recent_posts %}
    <div class="section mt-3">
      <h3 class="section-title"><span class="section-icon"></span> Your recent posts</h3>
      <div class="posts-list mt-2">
        {% for rp in recent_posts %}
        <div class="post-card">
          <div class="post-header">
            <div class="row-center gap-8">
              <div class="avatar-placeholder">{{ user.username|first|upper }}</div>
              <strong>{{ user.username }}</strong>
            </div>
            <div class="row-center gap-8">
              <span class="badge">{{ rp.emotion_type|title }}</span>
              <small class="post-date">{{ rp.created_at|date:"F j, Y, g:i a" }}</small>
            </div>
          </div>
          <div class="post-body"><p>{{ rp.content }}</p></div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </section>

  <aside class="home-side">
    <!-- Profile summary -->
    <div class="profile-card compact">
      <div class="avatar-wrapper">
        <div class="avatar-placeholder">{{ user.username|first|upper }}</div>
      </div>
      <div class="profile-summary">
        <div class="username">{{ user.username }}</div>
        <div class="email">{% if user.email %}{{ user.email }}{% else %}Email not available{% endif %}</div>
        {% if profile %}
        <div class="bio{% if not profile.bio %} empty{% endif %} mt-1">
          {% if profile.bio %}{{ profile.bio }}{% else %}No bio yet. Share a short vibe or message.{% endif %}
        </div>
        <div class="small muted mt-1">
          Name: {{ profile.name }} {{ profile.surname }}
        </div>
        {% endif %}
      </div>
      <div class="profile-actions">
        <button type="button" class="btn secondary" id="openProfileModal">Edit Profile</button>
        <a href="{% url 'profile' %}" class="btn secondary">View Profile</a>
        <a href="{% url 'feed' %}" class="btn secondary">Open Feed</a>
        <form action="{% url 'logout' %}" method="post" class="logout-form mt-2">
          {% csrf_token %}
          <button type="submit" class="btn danger">Logout</button>
        </form>
      </div>
    </div>

    {% include 'includes/profile_modal.html' %}

    <!-- Small trends preview -->
    <div class="trends section">
      <div class="section-title-row">
        <h3 class="section-title"><span class="section-icon"></span> Trending feelings</h3>
        <span class="muted small">Preview</span>
      </div>
      <ul class="trend-list compact">
        <li><a href="{% url 'feed' %}">#gratitude</a></li>
        <li><a href="{% url 'feed' %}">#support</a></li>
      </ul>
    </div>
  </aside>

  {% else %}
  <section class="guest-section">
    <h3>Welcome to I Feel You</h3>
    <p class="guest-text">A kind, supportive space to express your feelings.</p>
    <div class="auth-buttons">
      <a href="{% url 'login' %}" class="btn primary">Log In</a>
      <a href="{% url 'signup' %}" class="btn secondary">Sign Up</a>
    </div>
  </section>
  {% endif %}
</div>
<script defer src="{% static 'js/home.js' %}"></script>
{% endblock %}



